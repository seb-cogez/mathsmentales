import utils from"./utils.js";import MM from"./MM.js";export default class draw{constructor(tgt,btnId){const target=document.getElementById(tgt);let c=utils.create("canvas",{id:"painting",width:target.offsetWidth,height:target.offsetHeight+30});this.btn=document.querySelector("#"+btnId+" img"),this.btn.src="img/iconfinder_pencil_activ.png",target.appendChild(c),this.canvas=c,btnId.indexOf("btn-sample")>-1?(this.canvas.style.top=0,this.canvas.style.left=0):(this.canvas.style.top=target.offsetTop+"px",this.canvas.style.left=target.offsetLeft+"px"),this.mouse={x:0,y:0};const mouvement=event=>{let target=event.target,evt=event;MM.touched&&(target=event.touches[0].target,evt=event.touches[0]),this.mouse.x=evt.pageX-target.getBoundingClientRect().x,this.mouse.y=evt.pageY-target.getBoundingClientRect().y,this.enableDraw&&(this.started?(this.ctx.lineTo(this.mouse.x,this.mouse.y),this.ctx.stroke()):(this.started=!0,this.ctx.beginPath(),this.ctx.moveTo(this.mouse.x,this.mouse.y))),event.touches&&event.preventDefault()},yesDraw=event=>{this.enableDraw=!0,event.touches&&event.preventDefault()},noDraw=event=>{this.enableDraw=!1,this.started=!1,event.touches&&event.preventDefault()};this.ctx=this.canvas.getContext("2d"),this.ctx.strokeStyle="grey",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.stroke(),this.ctx.strokeStyle="blue",this.ctx.lineWidth=1,this.ctx.shadowBlur=1,this.ctx.shadowColor="blue",this.ctx.lineJoin="round",this.ctx.lineCap="round",this.canvas.addEventListener("mousemove",mouvement,!1),this.canvas.addEventListener("mousedown",yesDraw,!1),this.canvas.addEventListener("mouseup",noDraw,!1),this.canvas.addEventListener("mouseout",noDraw,!1),MM.touched&&(this.canvas.addEventListener("touchmove",mouvement,!1),this.canvas.addEventListener("touchstart",yesDraw,!1),this.canvas.addEventListener("touchend",noDraw,!1))}destroy(){this.btn.src="img/iconfinder_pencil_1055013.png",this.canvas.parentNode.removeChild(this.canvas),this.canvas=void 0,this.ctx=void 0}}