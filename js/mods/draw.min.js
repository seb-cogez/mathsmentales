import utils from"./utils.js";import MM from"./MM.js";export default class draw{constructor(t,s){const e=document.getElementById(t);let i=utils.create("canvas",{id:"painting",width:e.offsetWidth,height:e.offsetHeight+30});this.btn=document.querySelector("#"+s+" img"),this.btn.src="bootstrap-icons/icons/pencil-fill.svg",e.appendChild(i),this.canvas=i,s.indexOf("btn-sample")>-1?(this.canvas.style.top=0,this.canvas.style.left=0):(this.canvas.style.top=e.offsetTop+"px",this.canvas.style.left=e.offsetLeft+"px"),this.mouse={x:0,y:0};const n=t=>{let s=t.target,e=t;MM.touched&&(s=t.touches[0].target,e=t.touches[0]),this.mouse.x=e.pageX-s.getBoundingClientRect().x,this.mouse.y=e.pageY-s.getBoundingClientRect().y,this.enableDraw&&(this.started?(this.ctx.lineTo(this.mouse.x,this.mouse.y),this.ctx.stroke()):(this.started=!0,this.ctx.beginPath(),this.ctx.moveTo(this.mouse.x,this.mouse.y))),t.touches&&t.preventDefault()},a=t=>{this.enableDraw=!0,t.touches&&t.preventDefault()},h=t=>{this.enableDraw=!1,this.started=!1,t.touches&&t.preventDefault()};this.ctx=this.canvas.getContext("2d"),this.ctx.strokeStyle="grey",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.stroke(),this.ctx.strokeStyle="blue",this.ctx.lineWidth=1,this.ctx.shadowBlur=1,this.ctx.shadowColor="blue",this.ctx.lineJoin="round",this.ctx.lineCap="round",this.canvas.addEventListener("mousemove",n,!1),this.canvas.addEventListener("mousedown",a,!1),this.canvas.addEventListener("mouseup",h,!1),this.canvas.addEventListener("mouseout",h,!1),MM.touched&&(this.canvas.addEventListener("touchmove",n,!1),this.canvas.addEventListener("touchstart",a,!1),this.canvas.addEventListener("touchend",h,!1))}destroy(){this.btn.src="bootstrap-icons/icons/pencil.svg",this.canvas.parentNode.removeChild(this.canvas),this.canvas=void 0,this.ctx=void 0}}