import utils from"./utils.js";export{common as default};const pageOrientations=["portrait","paysage"],pageWidthes=["794","1123"];let pageFormat=0;document.getElementById("pageOrientation").onclick=evt=>{common.changeOrientation(evt)};const common={seed:"0000",generateQuestions(params){for(let index=0;index<params.cart.activities.length;index++)params.cart.activities[index].initialize();if(params.doublons){params.errorDouble=!1;for(let index=0;index<params.cart.activities.length;index++){const activity=params.cart.activities[index];activity.generate()}}else{let answers=[];params.errorDouble=!1;for(let index=0;index<params.cart.activities.length;index++){const activity=params.cart.activities[index];let double=!1,securite=100;do{activity.generate();let actanswers=[];double=!1,securite--,securite<0&&(params.errorDouble=!0);for(let n=0;n<activity.values.length;n++){if(answers.indexOf(activity.values[n])>-1||actanswers.indexOf(activity.values[n])>-1){double=!0;break}actanswers.push(activity.values[n])}if(!double)for(let n=0;n<activity.values.length;n++)answers.push(activity.values[n])}while(double&&!params.errorDouble)}}},changeOrientation(evt){let pagestyle=document.querySelector("head style");pagestyle.parentNode.removeChild(pagestyle),pagestyle=utils.create("style"),0===pageFormat?(pagestyle.innerHTML="@page{\n                size:A4 landscape;\n                margin:0.8cm;\n            }",document.body.setAttribute("layout","landscape")):(pagestyle.innerHTML="@page{\n                size:A4 portrait;\n                margin:0.8cm;\n            }",document.body.removeAttribute("layout")),document.head.appendChild(pagestyle),evt.target.innerHTML=pageOrientations[pageFormat],pageFormat=(pageFormat+1)%2},seedGenerator:function(){let str="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",code="";for(let i=0;i<6;i++)code+=str[Math.floor(Math.random()*str.length)];return code},setSeed(value){return this.seed=void 0!==value?value:this.seedGenerator(),utils.initializeAlea(this.seed),this.seed},checkURL(){const vars=utils.getUrlVars();if(void 0!==vars.embed){let expression,regex=new RegExp(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi);vars.embed.match(regex)&&(MM.embededIn=vars.embed)}if(void 0!==vars.c){vars.a?common.setSeed(vars.a):common.setSeed();let json=vars.c,allcarts=[];for(const i in json)carts[i]=new cart(i),allcarts.push(MM.carts[i].import(json[i],!1));Promise.all(allcarts).then(data=>{makePage()}).catch(err=>{let alert=utils.create("div",{id:"messageerreur",className:"message",innerHTML:"Impossible de charger les paniers :(<br>"+err});document.getElementById("creator-content").appendChild(alert),setTimeout(()=>{let div=document.getElementById("messageerreur");div.parentNode.removeChild(div)},3e3)})}},mathRender:function(all){if(void 0===all){const content=document.getElementById("creator-content");content.innerHTML=content.innerHTML.replace(/\$\$([^$]*)\$\$/gi,'<span class="math">$1</span>')}document.querySelectorAll(".math").forEach((function(item){var texTxt=item.innerHTML.replace(/\&amp\;/g,"&");let nbrgx=/(\d+\.*\d*)/g;texTxt=texTxt.replace(nbrgx,utils.toDecimalFr);try{katex.render(texTxt,item,{throwOnError:!1,errorColor:"#FFF",colorIsTextColor:!0}),utils.removeClass(item,"math")}catch(err){item.innerHTML="<span class='err'>"+err+" avec "+texTxt+"</span>"}}))}};